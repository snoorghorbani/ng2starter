{
  "version": 3,
  "file": "add-diagram.effects.js",
  "sources": [
    "ng://@soushians/diagram/projects/soushians/diagram/src/lib/effects/add-diagram.effects.ts"
  ],
  "sourcesContent": [
    "import { Injectable } from \"@angular/core\";\r\nimport { Router } from \"@angular/router\";\r\nimport { Observable } from \"rxjs/Observable\";\r\nimport { Action } from \"@ngrx/store\";\r\nimport { Actions, Effect } from \"@ngrx/effects\";\r\nimport { of } from \"rxjs/observable/of\";\r\nimport { Store } from \"@ngrx/store\";\r\nimport { map, switchMap, catchError } from \"rxjs/operators\";\r\n\r\nimport {\r\n\tAddDiagramActionTypes,\r\n\tAddDiagramAction,\r\n\tAddDiagramActionStart,\r\n\tAddDiagramActionSucceed,\r\n\tAddDiagramActionFailed,\r\n\tGenerateDiagramAction,\r\n\tStructureDefinitionStartAction,\r\n\tStructureDefinitionFinishedAction,\r\n\tDataLoadedAction\r\n} from \"../actions\";\r\nimport { DiagramService } from \"../services/diagram.service\";\r\nimport { AddDiagramApiModel } from \"../models\";\r\n\r\n@Injectable()\r\nexport class AddDiagramEffects {\r\n\tconstructor(private actions$: Actions<any>, private router: Router, private diagramService: DiagramService) {}\r\n\r\n\t@Effect()\r\n\taddDiagramRequest$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.ADD_DIAGRAM)\r\n\t\t.pipe(map(action => action.payload), map(data => new AddDiagramActionStart(data)));\r\n\r\n\t@Effect()\r\n\taddDiagram$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.ADD_DIAGRAM_START)\r\n\t\t.pipe(\r\n\t\t\tmap(action => action.payload),\r\n\t\t\tswitchMap((data: AddDiagramApiModel.Request) =>\r\n\t\t\t\tthis.diagramService\r\n\t\t\t\t\t.addDiagram(data)\r\n\t\t\t\t\t.pipe(\r\n\t\t\t\t\t\tmap(res => new AddDiagramActionSucceed(res)),\r\n\t\t\t\t\t\tcatchError(() => Observable.of(new AddDiagramActionFailed()))\r\n\t\t\t\t\t)\r\n\t\t\t)\r\n\t\t);\r\n\r\n\t@Effect({ dispatch: false })\r\n\tADD_DIAGRAM_SUCCEED$ = this.actions$.ofType(AddDiagramActionTypes.ADD_DIAGRAM_SUCCEED).pipe(\r\n\t\tmap(action => action.payload),\r\n\t\tmap(data => {\r\n\t\t\tthis.router.navigate([ \"diagrams\" ]);\r\n\t\t\treturn Observable.empty();\r\n\t\t})\r\n\t);\r\n\r\n\t@Effect()\r\n\tHAVE_ENDPOINT$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.HAVE_ENDPOINT)\r\n\t\t.pipe(map(action => action.payload), map(data => new DataLoadedAction(data)));\r\n\r\n\t@Effect()\r\n\tDATA_LOADED$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.DATA_LOADED)\r\n\t\t.pipe(map(action => action.payload), map(data => new StructureDefinitionStartAction(data)));\r\n\r\n\t@Effect()\r\n\tDIAGRAM_CONFIG_CHANGED$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.DIAGRAM_CONFIG_CHANGED)\r\n\t\t.pipe(map(action => action.payload), map(data => new GenerateDiagramAction(data)));\r\n\r\n\t@Effect()\r\n\tSTRUCTURE_DEFINITION_START$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.STRUCTURE_DEFINITION_START)\r\n\t\t.pipe(\r\n\t\t\tmap(action => action.payload),\r\n\t\t\tswitchMap(data => data.getDataStructure().map(() => new StructureDefinitionFinishedAction(data)))\r\n\t\t);\r\n\r\n\t@Effect()\r\n\tCOLUMNS_MAPPING_CHANGED$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.COLUMNS_MAPPING_CHANGED)\r\n\t\t.pipe(\r\n\t\t\tmap(action => action.payload),\r\n\t\t\tswitchMap(data => data.calculateColumns().map(() => new StructureDefinitionFinishedAction(data)))\r\n\t\t);\r\n\r\n\t@Effect()\r\n\tSTRUCTURE_DEFINITION_END$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.STRUCTURE_DEFINITION_END)\r\n\t\t// .skipUntil(this.actions$.ofType(AddDiagramActionTypes.DATA_LOADED))\r\n\t\t.pipe(\r\n\t\t\tmap(action => action.payload),\r\n\t\t\tswitchMap(data => data.calculateColumns().map(() => new GenerateDiagramAction(data)))\r\n\t\t);\r\n\r\n\t@Effect({ dispatch: false })\r\n\tGenerateDiagram$ = this.actions$\r\n\t\t.ofType(AddDiagramActionTypes.GENERATE_DIAGRAM)\r\n\t\t.pipe(map(action => action.payload), map(data => data.generateDiagram()));\r\n}\r\n"
  ],
  "names": [],
  "mappings": "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"
}
