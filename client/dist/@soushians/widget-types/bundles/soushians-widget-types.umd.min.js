!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@angular/forms"),require("@ngrx/store"),require("@soushians/widget"),require("@soushians/frontend-authentication"),require("@angular/common"),require("@angular/router"),require("@angular/material"),require("angular-froala-wysiwyg"),require("@angular/flex-layout")):"function"==typeof define&&define.amd?define("@soushians/widget-types",["exports","@angular/core","@angular/forms","@ngrx/store","@soushians/widget","@soushians/frontend-authentication","@angular/common","@angular/router","@angular/material","angular-froala-wysiwyg","@angular/flex-layout"],n):n((t.soushians=t.soushians||{},t.soushians["widget-types"]={}),t.ng.core,t.ng.forms,null,null,null,t.ng.common,t.ng.router,t.ng.material,null,t.ng["flex-layout"])}(this,function(t,n,o,e,i,r,a,l,u,s,c){"use strict";var m=function(){return(m=Object.assign||function(t){for(var n,o=1,e=arguments.length;o<e;o++)for(var i in n=arguments[o])Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i]);return t}).apply(this,arguments)},p=function(){function t(t){this.store=t,this._createFormGroup(),this.widget=new i.WidgetModel({type:"article"})}return t.prototype.upsert=function(){var t=m({},this.widget,this.widgetFormGroup.value,{Config:this.configFormGroup.value});this.store.dispatch(new i.UpsertWidgetStartAction(t))},t.prototype.ngOnInit=function(){this.widget!=undefined&&(this.widgetFormGroup.patchValue(this.widget),this.configFormGroup.patchValue(this.widget.Config))},t.prototype._createFormGroup=function(){this.configFormGroup=new o.FormGroup({content:new o.FormControl("")}),this.widgetFormGroup=new o.FormGroup({name:new o.FormControl("")})},t.decorators=[{type:n.Component,args:[{selector:"widget-article-upsert",template:'<mat-card>\n  <mat-card-header>\n    <mat-card-title fxLayout="row" fxLayoutGap="5px">\n      <mat-icon>gradient</mat-icon>\n      <span>ایجاد افزونه‌</span>\n    </mat-card-title>\n    \x3c!-- <mat-card-subtitle fxLayout="row" fxLayoutAlign="space-between center">\n      <span>\n        افزونه‌ مورد نظر را براساس نوع آن ایجاد نمایید ...\n      </span>\n    </mat-card-subtitle> --\x3e\n  </mat-card-header>\n  <mat-card-content>\n    <h3>نام افزونه</h3>\n    <div [formGroup]="widgetFormGroup">\n      <mat-form-field>\n        <input type="text" matInput placeholder="نام" formControlName="name">\n      </mat-form-field>\n    </div>\n    <mat-divider></mat-divider>\n    <h3>متن افزونه</h3>\n    <div [formGroup]="configFormGroup">\n      <div [froalaEditor] formControlName="content"></div>\n    </div>\n  </mat-card-content>\n  <mat-card-actions>\n    <button mat-button color="primary" (click)="upsert()">Add</button>\n  </mat-card-actions>\n</mat-card>',styles:[""]}]}],t.ctorParameters=function(){return[{type:e.Store}]},t.propDecorators={widget:[{type:n.Input}]},t}(),d=function(){function t(t){this.store=t}return t.prototype.ngOnInit=function(){this.havePermission$=this.store.select(r.getFrontendAuthenticationState)},t.decorators=[{type:n.Component,args:[{selector:"widget-article-view",template:'<div fxLayout="row" fxFlex="100" fxLayoutAlign="center start">\n  <button mat-mini-fab color="accent" *ngIf="havePermission$ | async" [routerLink]="[\'/widget/upsert/article\', (widget)?._id]">\n    <mat-icon>edit</mat-icon>\n  </button>\n\n  <div fxFlex="90" [froalaView]="(widget)?.Config.content" align="right" class="article"></div>\n</div>',styles:[":host{position:relative;display:block}.mat-mini-fab{position:absolute;top:-20px;right:-20px}.article{direction:rtl;text-align:right;padding-top:25px}"]}]}],t.ctorParameters=function(){return[{type:e.Store}]},t}(),f=function(){function t(t){this.store=t,this._createFormGroup(),this.widget=new i.WidgetModel({type:"links"})}return t.prototype.upsert=function(){var t=m({},this.widget,this.widgetFormGroup.value,{Config:this.configFormGroup.value});this.store.dispatch(new i.UpsertWidgetStartAction(t))},t.prototype.ngOnInit=function(){this.widget!=undefined&&(this.widgetFormGroup.patchValue(this.widget),this.configFormGroup.patchValue(this.widget.Config),this._update_links(this.widget.Config.links))},t.prototype.addlink=function(){this.configFormGroup.get("links").push(this._get_new_empty_link_item())},t.prototype.removelink=function(t){var n=this.configFormGroup.get("links");if(!(-1<n.controls.length))return n;n.removeAt(t)},t.prototype._createFormGroup=function(){this.configFormGroup=new o.FormGroup({links:new o.FormArray([])}),this.widgetFormGroup=new o.FormGroup({name:new o.FormControl("")})},t.prototype._get_new_empty_link_item=function(){return new o.FormGroup({url:new o.FormControl("/"),label:new o.FormControl("")})},t.prototype._update_links=function(t){var o=this;this.configFormGroup.get("links").reset(),t.forEach(function(t){var n=o._get_new_empty_link_item();n.patchValue(t),o.configFormGroup.get("links").push(n)})},t.decorators=[{type:n.Component,args:[{selector:"widget-links-upsert",template:'<mat-card fxFlex>\n  <mat-card-header>\n    <mat-card-title fxLayout="row" fxLayoutGap="5px">\n      <mat-icon>gradient</mat-icon>\n      <span>ایجاد افزونه‌</span>\n    </mat-card-title>\n    <mat-card-subtitle fxLayout="row" fxLayoutAlign="space-between center">\n      <span>\n        نام لینک موردنظر را وارد کرده و اطلاعات را کامل نمایید ...\n      </span>\n    </mat-card-subtitle>\n  </mat-card-header>\n  <mat-card-content>\n    <h3>نام ویجت</h3>\n    <div [formGroup]="widgetFormGroup">\n      <mat-form-field>\n        <input type="text" matInput placeholder="نام" formControlName="name">\n      </mat-form-field>\n    </div>\n    <mat-divider></mat-divider>\n    <br>\n    <div fxLayout="row" fxLayoutAlign="space-between center">\n      <h3>تنظیمات ویجت</h3>\n      <button color="primary" mat-fab fxFlexAlign="end" (click)="addlink()">\n        <mat-icon>add</mat-icon>\n      </button>\n    </div>\n    <div [formGroup]="configFormGroup">\n      <div fxFlex="nogrow" *ngFor="let ctrl of $any(configFormGroup.get(\'links\')).controls; let idx = index"\n        [formGroup]="ctrl">\n        <div [formGroup]="ctrl" fxLayout="row" fxLayoutGap="25px">\n          <button mat-icon-button fxFlex="nogrow" (click)="removelink(idx)">\n            <mat-icon>delete</mat-icon>\n          </button>\n          <mat-form-field fxFlex>\n            <input type="text" matInput placeholder="آدرس" formControlName="url">\n          </mat-form-field>\n          <mat-form-field fxFlex>\n            <input type="text" matInput placeholder="نام" formControlName="label">\n          </mat-form-field>\n        </div>\n      </div>\n    </div>\n  </mat-card-content>\n  <mat-card-actions>\n    <button mat-button color="primary" (click)="upsert()">ثبت</button>\n  </mat-card-actions>\n</mat-card>',styles:[""]}]}],t.ctorParameters=function(){return[{type:e.Store}]},t.propDecorators={widget:[{type:n.Input}]},t}(),g=function(){function t(t){this.store=t}return Object.defineProperty(t.prototype,"widget",{get:function(){return this._widget},set:function(t){t.Config.links.forEach(function(t){return t.url=t.url.startsWith("www.")?t.url="http://"+t.url:t.url}),t.Config.links.forEach(function(t){return t.isExternal=t.url.startsWith("http")}),this._widget=t},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.havePermission$=this.store.select(r.getFrontendAuthenticationState)},t.decorators=[{type:n.Component,args:[{selector:"widget-links-view",template:'<div fxLayout="column">\n  <div class="actions" fxLayout="row" fxFlex fxLayoutAlign="end">\n    <button fxFlex="nogrow" mat-icon-button color="primary" *ngIf="havePermission$ | async" [routerLink]="[\'/widget/upsert/links\', (widget)?._id]">\n      <mat-icon>edit</mat-icon>\n    </button>\n  </div>\n  <div fxLayout="row" fxFlex fxLayoutAlign="end">\n    <h3>\n      {{widget.name}}\n    </h3>\n  </div>\n  <mat-list fxLayout="column" fxFlex="100">\n    <mat-list-item fxLayout="column" *ngFor="let link of (widget)?.Config.links" fxFlex="100">\n      <mat-icon mat-list-icon>link</mat-icon>\n      <a fxLayout="row" *ngIf="!link.isExternal" fxFlex="grow" [routerLink]="[link.url]">\n        {{link.label}}\n      </a>\n      <a fxLayout="row" *ngIf="link.isExternal" target="_blank" fxFlex="grow" [href]="link.url">\n        {{link.label}}\n      </a>\n    </mat-list-item>\n  </mat-list>\n</div>',styles:[":host{position:relative;height:100%;display:block}:host:hover .actions{opacity:1;visibility:visible}mat-list a{text-decoration:none}.actions{transition:opacity .4s ease-in-out;opacity:0;visibility:hidden}.actions mat-icon{color:#121212}h3{padding-right:20px}"]}]}],t.ctorParameters=function(){return[{type:e.Store}]},t}(),h=function(){function t(t){this.store=t}return t.prototype.ngOnInit=function(){this.havePermission$=this.store.select(r.getFrontendAuthenticationState)},t.decorators=[{type:n.Component,args:[{selector:"widget-list-view",template:'<div fxLayout="column">\n  <div class="actions" fxLayout="row" fxFlex fxLayoutAlign="end">\n    <button fxFlex="nogrow" mat-icon-button color="primary" *ngIf="havePermission$ | async" [routerLink]="[\'/widget/upsert/links\', (widget)?._id]">\n      <mat-icon>edit</mat-icon>\n    </button>\n  </div>\n  <div fxLayout="row" fxFlex fxLayoutAlign="end">\n    <h3>\n      {{widget.name}}\n    </h3>\n  </div>\n  <mat-list fxLayout="column" fxFlex="100">\n    <mat-list-item fxLayout="column" *ngFor="let item of (widget)?.Config.list" fxFlex="100">\n      <mat-icon class="large-icon" mat-list-icon>account_box</mat-icon>\n      <h4 mat-line> {{item.title}}</h4>\n      <p mat-line> {{item.subtitle}} </p>\n      <p mat-line> {{item.description}} </p>\n    </mat-list-item>\n  </mat-list>\n</div>',styles:[":host{position:relative;height:100%;display:block}:host:hover .actions{opacity:1;visibility:visible}mat-list a{text-decoration:none}.actions{transition:opacity .4s ease-in-out;opacity:0;visibility:hidden}.actions mat-icon{color:#121212}h3{padding-right:20px}.large-icon{font-size:50px!important;width:50px!important;height:50px!important;color:#999}mat-list{direction:rtl}"]}]}],t.ctorParameters=function(){return[{type:e.Store}]},t}(),y=function(){function t(t){this.store=t,this._createFormGroup(),this.widget=new i.WidgetModel({type:"list"})}return t.prototype.upsert=function(){var t=m({},this.widget,this.widgetFormGroup.value,{Config:this.configFormGroup.value});this.store.dispatch(new i.UpsertWidgetStartAction(t))},t.prototype.ngOnInit=function(){this.widget!=undefined&&(this.widgetFormGroup.patchValue(this.widget),this.configFormGroup.patchValue(this.widget.Config),this._update_list(this.widget.Config.list))},t.prototype.addItem=function(){this.configFormGroup.get("list").push(this._get_new_empty_list_item())},t.prototype.removelist=function(t){var n=this.configFormGroup.get("list");if(!(-1<n.controls.length))return n;n.removeAt(t)},t.prototype._createFormGroup=function(){this.configFormGroup=new o.FormGroup({list:new o.FormArray([])}),this.widgetFormGroup=new o.FormGroup({name:new o.FormControl("")})},t.prototype._get_new_empty_list_item=function(){return new o.FormGroup({title:new o.FormControl(""),subtitle:new o.FormControl(""),description:new o.FormControl("")})},t.prototype._update_list=function(t){var o=this;this.configFormGroup.get("list").reset(),t.forEach(function(t){var n=o._get_new_empty_list_item();n.patchValue(t),o.configFormGroup.get("list").push(n)})},t.decorators=[{type:n.Component,args:[{selector:"widget-list-upsert",template:'<mat-card>\n  <mat-card-header>\n    <mat-card-title fxLayout="row" fxLayoutGap="5px">\n      <mat-icon>gradient</mat-icon>\n      <span>ایجاد افزونه‌</span>\n    </mat-card-title>\n    \x3c!-- <mat-card-subtitle fxLayout="row" fxLayoutAlign="space-between center">\n      <span>\n        افزونه‌ مورد نظر را براساس نوع آن ایجاد نمایید ...\n      </span>\n    </mat-card-subtitle> --\x3e\n  </mat-card-header>\n  <mat-card-content>\n    <h3>نام افزونه</h3>\n    <div [formGroup]="widgetFormGroup">\n      <mat-form-field>\n        <input type="text" matInput placeholder="نام" formControlName="name">\n      </mat-form-field>\n    </div>\n    <mat-divider></mat-divider>\n    <h3>متن افزونه</h3>\n    <button color="primary" mat-fab fxFlexAlign="end" (click)="addItem()">\n      <mat-icon>add</mat-icon>\n    </button>\n    <div [formGroup]="configFormGroup">\n      <div fxFlex="nogrow" *ngFor="let ctrl of $any(configFormGroup.get(\'list\')).controls; let idx = index" [formGroup]="ctrl">\n        <button mat-icon-button fxFlex="nogrow" (click)="removelist(idx)">\n          <mat-icon>delete</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <input type="text" matInput placeholder="عنوان" formControlName="title">\n        </mat-form-field>\n        <mat-form-field fxFlex>\n          <input type="text" matInput placeholder="زیرعنوان" formControlName="subtitle">\n        </mat-form-field>\n        <mat-form-field fxFlex>\n          <input type="text" matInput placeholder="توضیحات" formControlName="description">\n        </mat-form-field>\n      </div>\n    </div>\n  </mat-card-content>\n  <mat-card-actions>\n    <button mat-button color="primary" (click)="upsert()">ثبت</button>\n  </mat-card-actions>\n</mat-card>',styles:[""]}]}],t.ctorParameters=function(){return[{type:e.Store}]},t.propDecorators={widget:[{type:n.Input}]},t}(),x=function(){function t(){}return t.decorators=[{type:n.NgModule,args:[{imports:[a.CommonModule,l.RouterModule,u.MatExpansionModule,u.MatSnackBarModule,u.MatIconModule,u.MatButtonModule,u.MatCardModule,u.MatSelectModule,u.MatInputModule,u.MatFormFieldModule,u.MatTabsModule,u.MatRadioModule,u.MatDividerModule,o.FormsModule,o.ReactiveFormsModule,u.MatSlideToggleModule,u.MatDividerModule,u.MatCheckboxModule,u.MatTableModule,u.MatListModule,c.FlexLayoutModule,s.FroalaEditorModule.forRoot(),s.FroalaViewModule.forRoot()],declarations:[p,d,f,g,y,h],entryComponents:[p,d,f,g,y,h],exports:[d]}]}],t}();t.ArticleUpsertComponent=p,t.ArticleViewComponent=d,t.LinksUpsertComponent=f,t.LinksViewComponent=g,t.ListViewComponent=h,t.ListUpsertComponent=y,t.NgsWidgetTypesModule=x,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=soushians-widget-types.umd.min.js.map