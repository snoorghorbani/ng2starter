!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@ngrx/store"),require("@angular/router"),require("rxjs"),require("rxjs/operators"),require("@angular/common/http"),require("@soushians/shared"),require("@angular/common"),require("@angular/material"),require("@angular/flex-layout")):"function"==typeof define&&define.amd?define("@soushians/page",["exports","@angular/core","@ngrx/store","@angular/router","rxjs","rxjs/operators","@angular/common/http","@soushians/shared","@angular/common","@angular/material","@angular/flex-layout"],e):e((t.soushians=t.soushians||{},t.soushians.page={}),t.ng.core,null,t.ng.router,t.rxjs,t.rxjs.operators,t.ng.common.http,null,t.ng.common,t.ng.material,t.ng["flex-layout"])}(this,function(t,e,n,r,o,i,u,a,s,c,p){"use strict";var f,d,l=function(){function t(){}return t.decorators=[{type:e.Component,args:[{selector:"page-root",template:"<router-outlet></router-outlet>"}]}],t}(),g=function(){function t(){}return t.decorators=[{type:e.Component,args:[{template:'<div fxLayout="row" fxLayoutAlign="center center">\n    <div fxFlex="50">\n        []upsertt\n    </div>\n</div>'}]}],t}(),h=function(){this.type="[GET_PAGES][API][GetPages] start"},y=function(){function t(t){this.store=t,this.pages$=this.store.select(function(t){return t.pages.db.data})}return t.prototype.ngOnInit=function(){this.store.dispatch(new h)},t.decorators=[{type:e.Component,args:[{template:'<div fxLayout="row" fxLayoutAlign="center" fxLayoutGap="25px">\n  <div fXFlex="30" fxLayout="row wrap">\n    <button fxFlex="100" color="primary" mat-raised-button routerLink="../upsert/article">\n      Add Article\n    </button>\n    <button fxFlex="100" color="primary" mat-raised-button routerLink="../upsert/links">\n      Add Links\n    </button>\n  </div>\n  <div fxFlex="70" fxLayout="row wrap" fxLayoutGap="25px">\n    <mat-card class="cards-item" *ngFor="let item of (pages$ | async)" fxFlex="33" fxLayout="row">\n      <div fxFlex>\n        <a [routerLink]="[\'../upsert\' ,  item.type,  item._id]">\n          <mat-icon aria-label="edit page">edit</mat-icon>\n        </a>\n      </div>\n      <div fxFlex>\n        {{item.name}}\n      </div>\n      <div fxFlex>\n        {{item.type}}\n      </div>\n    </mat-card>\n  </div>\n</div>'}]}],t.ctorParameters=function(){return[{type:n.Store}]},t}(),m=[{path:"pages",component:l,children:[{path:"management",component:y},{path:"upsert/:type",component:g},{path:"upsert/:type/:_id",component:g}]}],v=r.RouterModule.forChild(m),x={env:{production:!1,frontend_server:"frontend_server/did/not/set"},endpoints:{upsert:"/api/page",find:"/api/page",get:"/api/page/${model._id}"}},b=new e.InjectionToken("PageModuleConfig"),_=function(){function t(t,e){this.store=e,this.config$=new o.BehaviorSubject(x),this._config=Object.assign({},x,t),this.config$.next(this._config)}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[b]}]},{type:n.Store}]},t}();!function(t){var e=function(){function t(e){void 0===e&&(e={});var n=this;Object.keys(e).forEach(function(t){return n[t]=e[t]})}return t.prototype.getRequestBody=function(){return{}},t}();t.Request=e;var n=function(){};t.Response=n}(f||(f={})),function(t){var e=function(){function t(e){void 0===e&&(e={});var n=this;Object.keys(e).forEach(function(t){return n[t]=e[t]})}return t.prototype.getRequestBody=function(){return{}},t}();t.Request=e;var n=function(){};t.Response=n}(d||(d={}));var j,q=function(t){this.payload=t,this.type="[PAGE][API][GetPage] start"},w=function(t){var e=void 0===t?{}:t,n=e._id,r=e.name,o=e.type,i=e.Config;this._id=n,this.name=r||"",this.type=o,this.Config=i||{}};!function(t){var e=function(){function t(t){void 0===t&&(t={}),this.page=new w(t)}return t.prototype.getRequestBody=function(){return this.page},t}();t.Request=e;var n=function(){};t.Response=n}(j||(j={}));var L=function(){function t(t,e,n,r){this.http=t,this.store=e,this.configurationService=n,this._location=r}return t.prototype.get=function(e){var n=this;return this.configurationService.config$.pipe(i.filter(function(t){return""!==t.endpoints.get}),i.take(1),i.switchMap(function(t){return n.http.get(a.stringTemplate(t.env.frontend_server+t.endpoints.get,{_id:e}))}),i.map(function(t){return t.Result}))},t.prototype.getPages=function(){var e=this;return this.configurationService.config$.pipe(i.filter(function(t){return""!=t.endpoints.find}),i.switchMap(function(t){return e.http.get(t.env.frontend_server+t.endpoints.find)}),i.map(function(t){return t.Result}))},t.prototype.upsert=function(t){var e=this,n=new j.Request(t);return this.configurationService.config$.pipe(i.filter(function(t){return""!=t.endpoints.upsert}),i.take(1),i.switchMap(function(t){return e.http.post(t.env.frontend_server+t.endpoints.upsert,n.getRequestBody())}),i.map(function(t){return t.Result}),i.tap(function(){return e._location.back()}))},t.prototype.selectById=function(e){var n=this,r=new o.BehaviorSubject(undefined);return this.store.select(function(t){return t.pages.db.data}).pipe(i.filter(function(t){return null!=t}),i.map(function(t){return t.find(function(t){return t._id==e})}),i.tap(function(t){null==t&&n.store.dispatch(new q(e))})).subscribe(function(t){return r.next(t)}),r.asObservable()},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:u.HttpClient},{type:n.Store},{type:_},{type:s.Location}]},t}(),M=function(){function t(t,e,n,r,o){this.store=t,this.service=e,this.configurationService=n,this.resolver=r,this.container=o}return Object.defineProperty(t.prototype,"oid",{set:function(t){this._selectPage(t)},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){},t.prototype._selectPage=function(t){this.page$=this.service.selectById(t)},t.decorators=[{type:e.Component,args:[{template:""}]}],t.ctorParameters=function(){return[{type:n.Store},{type:L},{type:_},{type:e.ComponentFactoryResolver},{type:e.ViewContainerRef}]},t.propDecorators={oid:[{type:e.Input}]},t}(),P=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[s.CommonModule,v,c.MatCardModule,c.MatButtonModule,c.MatIconModule,p.FlexLayoutModule],declarations:[M,y,l,g],exports:[]}]}],t}();t.PageModule=P,t.MODULE_DEFAULT_CONFIG=x,t.MODULE_CONFIG_TOKEN=b,t.ɵc=y,t.ɵa=v,t.ɵb=l,t.ɵh=_,t.ɵg=L,t.ɵe=g,t.ɵf=M,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=soushians-page.umd.min.js.map